(function(j,w){typeof exports=="object"&&typeof module<"u"?module.exports=w():typeof define=="function"&&define.amd?define(w):(j=typeof globalThis<"u"?globalThis:j||self,j.request=w())})(this,function(){"use strict";var le=Object.defineProperty;var he=(j,w,T)=>w in j?le(j,w,{enumerable:!0,configurable:!0,writable:!0,value:T}):j[w]=T;var R=(j,w,T)=>(he(j,typeof w!="symbol"?w+"":w,T),T);var j=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function w(O){return O&&O.__esModule&&Object.prototype.hasOwnProperty.call(O,"default")?O.default:O}var T={exports:{}};(function(O,o){(function(x,h){O.exports=h()})(j,function(){return function(d){var x={};function h(c){if(x[c])return x[c].exports;var a=x[c]={i:c,l:!1,exports:{}};return d[c].call(a.exports,a,a.exports,h),a.l=!0,a.exports}return h.m=d,h.c=x,h.i=function(c){return c},h.d=function(c,a,e){h.o(c,a)||Object.defineProperty(c,a,{configurable:!1,enumerable:!0,get:e})},h.n=function(c){var a=c&&c.__esModule?function(){return c.default}:function(){return c};return h.d(a,"a",a),a},h.o=function(c,a){return Object.prototype.hasOwnProperty.call(c,a)},h.p="",h(h.s=2)}([function(d,x,h){var c=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(a){return typeof a}:function(a){return a&&typeof Symbol=="function"&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a};d.exports={type:function(e){return Object.prototype.toString.call(e).slice(8,-1).toLowerCase()},isObject:function(e,g){return g?this.type(e)==="object":e&&(typeof e>"u"?"undefined":c(e))==="object"},isFormData:function(e){return typeof FormData<"u"&&e instanceof FormData},trim:function(e){return e.replace(/(^\s*)|(\s*$)/g,"")},encode:function(e){return encodeURIComponent(e).replace(/%40/gi,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")},formatParams:function(e){var g="",m=!0,l=this;if(!this.isObject(e))return e;function s(r,n){var i=l.encode,C=l.type(r);if(C=="array")r.forEach(function(u,b){l.isObject(u)||(b=""),s(u,n+("%5B"+b+"%5D"))});else if(C=="object")for(var t in r)n?s(r[t],n+"%5B"+i(t)+"%5D"):s(r[t],i(t));else m||(g+="&"),m=!1,g+=n+"="+i(r)}return s(e,""),g},merge:function(e,g){for(var m in g)e.hasOwnProperty(m)?this.isObject(g[m],1)&&this.isObject(e[m],1)&&this.merge(e[m],g[m]):e[m]=g[m];return e}}},,function(d,x,h){var c=function(){function l(s,r){for(var n=0;n<r.length;n++){var i=r[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(s,i.key,i)}}return function(s,r,n){return r&&l(s.prototype,r),n&&l(s,n),s}}();function a(l,s){if(!(l instanceof s))throw new TypeError("Cannot call a class as a function")}var e=h(0),g=typeof document<"u",m=function(){function l(s){a(this,l),this.engine=s||XMLHttpRequest,this.default=this;function r(t){var u=void 0,b=void 0;function L(){t.p=u=b=null}e.merge(t,{lock:function(){u||(t.p=new Promise(function(E,U){u=E,b=U}))},unlock:function(){u&&(u(),L())},clear:function(){b&&(b("cancel"),L())}})}var n=this.interceptors={response:{use:function(u,b){this.handler=u,this.onerror=b}},request:{use:function(u){this.handler=u}}},i=n.request,C=n.response;r(C),r(i),this.config={method:"GET",baseURL:"",headers:{},timeout:0,params:{},parseJson:!0,withCredentials:!1}}return c(l,[{key:"request",value:function(r,n,i){var C=this,t=new this.engine,u="Content-Type",b=u.toLowerCase(),L=this.interceptors,P=L.request,E=L.response,U=P.handler,G=new Promise(function(z,I){e.isObject(r)&&(i=r,r=i.url),i=i||{},i.headers=i.headers||{};function Q(f){return f&&f.then&&f.catch}function X(f,y){f?f.then(function(){y()}):y()}function se(f){n=f.body,r=e.trim(f.url);var y=e.trim(f.baseURL||"");if(!r&&g&&!y&&(r=location.href),r.indexOf("http")!==0){var _=r[0]==="/";if(!y&&g){var K=location.pathname.split("/");K.pop(),y=location.protocol+"//"+location.host+(_?"":K.join("/"))}if(y[y.length-1]!=="/"&&(y+="/"),r=y+(_?r.substr(1):r),g){var V=document.createElement("a");V.href=r,r=V.href}}var W=e.trim(f.responseType||""),H=["GET","HEAD","DELETE","OPTION"].indexOf(f.method)!==-1,Y=e.type(n),D=f.params||{};H&&Y==="object"&&(D=e.merge(n,D)),D=e.formatParams(D);var J=[];D&&J.push(D),H&&n&&Y==="string"&&J.push(n),J.length>0&&(r+=(r.indexOf("?")===-1?"?":"&")+J.join("&")),t.open(f.method,r);try{t.withCredentials=!!f.withCredentials,t.timeout=f.timeout||0,W!=="stream"&&(t.responseType=W)}catch{}var Z=f.headers[u]||f.headers[b],A="application/x-www-form-urlencoded";e.trim((Z||"").toLowerCase())===A?n=e.formatParams(n):!e.isFormData(n)&&["object","array"].indexOf(e.type(n))!==-1&&(A="application/json;charset=utf-8",n=JSON.stringify(n)),Z||H||(f.headers[u]=A);for(var N in f.headers)if(N===u&&e.isFormData(n))delete f.headers[N];else try{t.setRequestHeader(N,f.headers[N])}catch{}function ee(p,v,S){X(E.p,function(){if(p){S&&(v.request=f);var q=p.call(E,v,Promise);v=q===void 0?v:q}Q(v)||(v=Promise[S===0?"resolve":"reject"](v)),v.then(function(F){z(F)}).catch(function(F){I(F)})})}function M(p){p.engine=t,ee(E.onerror,p,-1)}function $(p,v){this.message=p,this.status=v}t.onload=function(){try{var p=t.response||t.responseText;p&&f.parseJson&&(t.getResponseHeader(u)||"").indexOf("json")!==-1&&!e.isObject(p)&&(p=JSON.parse(p));var v=t.responseHeaders;if(!v){v={};var S=(t.getAllResponseHeaders()||"").split(`\r
`);S.pop(),S.forEach(function(B){if(!!B){var te=B.split(":")[0];v[te]=t.getResponseHeader(te)}})}var q=t.status,F=t.statusText,k={data:p,headers:v,status:q,statusText:F};if(e.merge(k,t._response),q>=200&&q<300||q===304)k.engine=t,k.request=f,ee(E.handler,k,0);else{var re=new $(F,q);re.response=k,M(re)}}catch(B){M(new $(B.msg,t.status))}},t.onerror=function(p){M(new $(p.msg||"Network Error",0))},t.ontimeout=function(){M(new $("timeout [ "+t.timeout+"ms ]",1))},t._options=f,setTimeout(function(){t.send(H?null:n)},0)}X(P.p,function(){e.merge(i,JSON.parse(JSON.stringify(C.config)));var f=i.headers;f[u]=f[u]||f[b]||"",delete f[b],i.body=n||i.body,r=e.trim(r||""),i.method=i.method.toUpperCase(),i.url=r;var y=i;U&&(y=U.call(P,i,Promise)||i),Q(y)||(y=Promise.resolve(y)),y.then(function(_){_===i?se(_):z(_)},function(_){I(_)})})});return G.engine=t,G}},{key:"all",value:function(r){return Promise.all(r)}},{key:"spread",value:function(r){return function(n){return r.apply(null,n)}}}]),l}();m.default=m,["get","post","put","patch","head","delete"].forEach(function(l){m.prototype[l]=function(s,r,n){return this.request(s,r,e.merge({method:l},n))}}),["lock","unlock","clear"].forEach(function(l){m.prototype[l]=function(){this.interceptors.request[l]()}}),d.exports=m}])})})(T);const ne=w(T.exports);var ie=T.exports,fe=new ie,oe=fe;function ae(O){const o=new ne(O);return o.config.headers={Authorization:"4b8b91aa08d98acd65d2fa8d0c4fbf4ab3e4fe01","Content-Type":"application/json"},o.config.timeout=5*1e3,o.config.baseURL="https://api.github.com",o}function ce(O,o){return O.replace(/{owner}/g,o.owner).replace(/{repo}/g,o.repo)}class ue{constructor(o){R(this,"token");R(this,"owner");R(this,"repo");R(this,"fly");R(this,"ref","api");var d;this.config(o),this.fly=(d=o==null?void 0:o.fly)!=null?d:ae(o==null?void 0:o.engine)}config(o){var d,x;o!=null&&o.token&&(this.token=o.token),this.owner=(d=o==null?void 0:o.owner)!=null?d:"pinghuazhuang",this.repo=(x=o==null?void 0:o.repo)!=null?x:"note"}read(o){return oe.get(ce(`{owner}/{repo}/api/${o}`,this).replace(/{path}/g,o),{ref:this.ref},{headers:{"Content-Type":"text/plain"},baseURL:"https://raw.githubusercontent.com"}).then(d=>JSON.parse(d.data))}}return new ue});
